{
  "name": "Tetris",
  "tagline": "俄罗斯方块html",
  "body": "<!DOCTYPE html>\r\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=GBK\"></head><body>\r\n<div id=\"box\" style=\"width:252px;font:25px/25px 宋体;background:#000;color:#9f9;text-shadow:2px 3px 1px #0f0;\"></div>\r\n<script>\r\nvar map=eval(\"[\"+Array(23).join(\"0x801,\")+\"0xfff]\");\r\nvar tatris=[[0x6600],[0x2222,0xf00],[0xc600,0x2640],[0x6c00,0x4620],[0x4460,0x2e0,0x6220,0x740],[0x2260,0xe20,0x6440,0x4700],[0x2620,0x720,0x2320,0x2700]];\r\nvar keycom={\"38\":\"rotate(1)\",\"40\":\"down()\",\"37\":\"move(2,1)\",\"39\":\"move(0.5,-1)\"};\r\nvar dia, pos, bak, run;\r\nfunction start(){\r\ndia=tatris[~~(Math.random()*7)];\r\nbak=pos={fk:[],y:0,x:4,s:~~(Math.random()*4)};\r\nrotate(0);\r\n}\r\nfunction over(){\r\ndocument.onkeydown=null;\r\nclearInterval(run);\r\nalert(\"GAME OVER\");\r\n}\r\nfunction update(t){\r\nbak={fk:pos.fk.slice(0),y:pos.y,x:pos.x,s:pos.s};\r\nif(t) return;\r\nfor(var i=0,a2=\"\"; i<22; i++)\r\na2+=map[i].toString(2).slice(1,-1)+\"<br/>\";\r\nfor(var i=0,n; i<4; i++)\r\nif(/([^0]+)/.test(bak.fk[i].toString(2).replace(/1/g,\"\\u25a1\")))\r\na2=a2.substr(0,n=(bak.y+i+1)*15-RegExp.$_.length-4)+RegExp.$1+a2.slice(n+RegExp.$1.length);\r\ndocument.getElementById(\"box\").innerHTML=a2.replace(/1/g,\"\\u25a0\").replace(/0/g,\"\\u3000\");\r\n}\r\nfunction is(){\r\nfor(var i=0; i<4; i++)\r\nif((pos.fk[i]&map[pos.y+i])!=0) return pos=bak;\r\n}\r\nfunction rotate(r){\r\nvar f=dia[pos.s=(pos.s+r)%dia.length];\r\nfor(var i=0; i<4; i++)\r\npos.fk[i]=(f>>(12-i*4)&15)<<pos.x;\r\nupdate(is());\r\n}\r\nfunction down(){\r\n++pos.y;\r\nif(is()){\r\nfor(var i=0; i<4 && pos.y+i<22; i++)\r\nif((map[pos.y+i]|=pos.fk[i])==0xfff)\r\nmap.splice(pos.y+i,1), map.unshift(0x801);\r\nif(map[1]!=0x801) return over();\r\nstart();\r\n}\r\nupdate();\r\n}\r\nfunction move(t,k){\r\npos.x+=k;\r\nfor(var i=0; i<4; i++)\r\npos.fk[i]*=t;\r\nupdate(is());\r\n}\r\ndocument.onkeydown=function(e){\r\neval(keycom[(e?e:event).keyCode]);\r\n};\r\nstart();\r\nrun=setInterval(\"down()\",400);\r\n</script>\r\n</body></html>",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}